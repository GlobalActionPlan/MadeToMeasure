<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      metal:define-macro="master"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="MadeToMeasure">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
        <metal:page_title define-slot="head_title">
           <title>Made to measure</title>
        </metal:page_title>
    <meta name="keywords" content="python web application" />
    <meta name="description" content="pyramid web application" />

    <link href="${request.application_url}/static/reset.css" rel="stylesheet" type="text/css" />
    <link href="${request.application_url}/static/main.css" rel="stylesheet" type="text/css" />

    <style tal:condition="organisation and hex_color|False" type="text/css">
        a,
        button {
            color: ${hex_color};
        }
        button {
            border: 1px solid ${hex_color};
        }
        #page-wrapper {
            background-color: ${hex_color};
        }

    </style>
    <style tal:condition="organisation and logo_link|False" type="text/css">
        #logo {
            background-image: url(${logo_link});
        }
    </style>
    <tal:deform tal:condition="form_resources|False">
        <tal:css repeat="css_file form_resources['css']|[]">
        <link rel="stylesheet"
              tal:attributes="href string:/deform/${css_file}" type="text/css" />
        </tal:css>
        <tal:js repeat="js_file form_resources['js']|[]">
        <script type="text/javascript"
                tal:attributes="src string:/deform/${js_file}"></script>
        </tal:js>
        <script type="text/javascript">
            deform.load();
        </script>
    </tal:deform>

    <metal:head define-slot="head"></metal:head>
    
</head>
<body>
    
    <div id="page-wrapper"><!-- Wraps around the whole page -->
    
        <div id="page-header">
            <!-- for logo etc -->
            
            <div id="logo"></div>
            
            <div tal:condition="userid" id="system-toolbar">
                
                <div id="your">
                    <span i18n:translate="">Your time</span>
                    <span tal:content="user_dt.dt_format(user_dt.localnow())"></span>
                    |
                    <a href="${request.resource_url(user)}"
                       title="Click to go to profile. There you can make changes as well."
                       i18n:attributes="title">${user.title} (${userid})</a>
                    |
                    <a href="${request.resource_url(root, 'logout')}" i18n:translate="">Logout</a>
                </div>

                <div id="global">
                    Global:
                    <a href="${request.resource_url(root['participants'])}" i18n:translate="">Participants</a> |
                    <a href="${request.resource_url(root['questions'])}" i18n:translate="">Questions</a> |
                    <a href="${request.resource_url(root['users'])}" i18n:translate="">System users</a> |
                    <a href="${request.resource_url(root, 'permissions')}" i18n:translate="">Permissions</a>
                </div>

                <div tal:condition="organisation|False" id="organisation">
                    <span tal:content="organisation.title">Title</span>:
                    <a href="${request.resource_url(organisation['surveys'])}" i18n:translate="">Surveys</a> |
                    <a href="${request.resource_url(organisation, 'permissions')}" i18n:translate="">Permissions</a> |
                    <a href="${request.resource_url(organisation, 'variants')}" i18n:translate="">Variants</a>
                </div>
                
            </div>
            
        </div>
        
        <div id="main-area-wrapper"><div id="main-area">

            <div id="context-toolbar" tal:condition="userid|False">
        
                <tal:add tal:condition="addable_types">
                    <tal:iterate repeat="type_id addable_types">
                        <a class="button add"
                           href="${request.resource_url(context, 'add', query={'content_type': type_id})}">
                            <span i18n:translate="">Add</span>
                            ${type_id}
                        </a> |
                    </tal:iterate>
                </tal:add>
                <a class="button edit" href="${request.resource_url(context) + 'edit'}" i18n:translate="">Edit</a> |
                <tal:organisation condition="context.content_type == 'Organisation'">
                   <a class="button variants"
                       href="${request.resource_url(context, 'variants')}"
                       i18n:translate="">Variants</a> |
                </tal:organisation>
                <tal:survey condition="context.content_type == 'Survey'">
                    <a class="button invitaions" 
                       href="${request.resource_url(context, 'invitation_emails')}"
                       i18n:translate="">Invitations</a> |
                    <a class="button participants"
                       href="${request.resource_url(context, 'participants')}"
                       i18n:translate="">Participants</a> |
                    <a class="button results"
                       href="${request.resource_url(context, 'results')}"
                       i18n:translate="">Results</a> |
                    <a class="button translations"
                       href="${request.resource_url(context, 'translations')}"
                       i18n:translate="">Translations</a> |
                    <a class="button reorder"
                       href="${request.resource_url(context, 'reorder')}"
                       i18n:translate="">Reorder sections</a> |
                    <a class="button export"
                       href="${request.resource_url(context, 'export.csv')}"
                       i18n:translate="">Export</a> |
                    <a class="button export"
                       href="${request.resource_url(context, 'clone')}"
                       i18n:translate="">Clone</a>
                </tal:survey>
                <tal:survey condition="context.content_type == 'SurveySection'">
                    <a class="button reorder"
                       href="${request.resource_url(context, 'reorder')}"
                       i18n:translate="">Reorder questions</a>
                </tal:survey>
                <tal:user condition="context.content_type == 'User'">
                    <a class="button change_password"
                       href="${request.resource_url(context, 'change_password')}"
                       i18n:translate="">Change password</a>
                </tal:user>
            </div>

            <div tal:condition="userid" id="path-bar">
                <tal:iterate repeat="obj path">
                    &raquo;
                    <a href="${resource_url(obj, request)}" tal:content="obj.title">Title</a>
                </tal:iterate>
            </div>

            <div id="flash_messages" tal:define="flash_messages flash_messages()">
                <tal:iterate repeat="flash_message flash_messages">
                    <div class="message" tal:content="structure flash_message">Message</div>
                </tal:iterate>
            </div>

            <metal:heading define-slot="page_heading">
                <h1 tal:content="context.title">Title</h1>
            </metal:heading>
        
            <div id="content">
                <metal:main-content define-slot="content">
                    <!-- Content slot, where other templates render -->
                </metal:main-content>
            </div>
        </div></div><!-- main area and wrapper -->
    
    </div>
    <div id="footer" tal:condition="footer_html" tal:content="structure footer_html">
        Footer html code
    </div>

    <div class="js_translation" style="display: none !important;">
       <pre class="js_trans_confirm_back" i18n:translate="">If you go back, the changes made here will be permanently lost.</pre>
    </div>

    <script type="text/javascript" src="${request.application_url}/static/main.js"></script>
    <script tal:condition="userid|False" type="text/javascript" src="${request.application_url}/static/authenticated.js"></script>

</body>
</html>
